function t(t,e,n,i){return new(n||(n=Promise))((function(c,o){function r(t){try{a(i.next(t))}catch(t){o(t)}}function s(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?c(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,s)}a((i=i.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;class e{constructor(){this.pc=new RTCPeerConnection,this.stream=new MediaStream,this.pc.ontrack=t=>{this.stream.addTrack(t.track)}}play(e){return t(this,void 0,void 0,(function*(){if(e.includes("localhost")||e.includes("127.0.0.1"))throw"向 127.0.0.1 或 localhost 请求视频流无效";this.pc.addTransceiver("audio",{direction:"recvonly"}),this.pc.addTransceiver("video",{direction:"recvonly"});const n=yield this.pc.createOffer();yield this.pc.setLocalDescription(n);try{const i=yield function(e,n){return t(this,void 0,void 0,(function*(){const t={streamurl:e,sdp:n.sdp},i=yield fetch("/rtc/v1/play/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return yield i.json()}))}(e,n);return yield this.pc.setRemoteDescription(new RTCSessionDescription({type:"answer",sdp:i.sdp})),!0}catch(t){throw"请求视频流失败"}}))}close(){this.pc&&this.pc.close()}}export{e as SrsRtcPlayerAsync};
